<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Add Lesson</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
    <style>
        /* Your styles here */
    </style>
</head>
<body>
    <!-- Navigation Bar -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <a class="navbar-brand" href="/admin_dashboard">Admin Panel</a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNav">
            <ul class="navbar-nav">
                <li class="nav-item active">
                    <a class="nav-link" href="/add_lesson">Modify Lesson</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#">Modify Users</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="/modify_subjects">Modify Subjects</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#">Modify Family</a>
                </li>
                <!-- Add more links as needed -->
            </ul>
        </div>
    </nav>
    <div class="container mt-4">
        <h2>Add a New Lesson</h2>
        <form action="{{ url_for('add_lesson') }}" method="post">
            <label for="schooltype_id">School Type:</label>
            <select id="schooltype_id" name="schooltype_id" required onchange="updateSubjects()">
                <option value="">Select a School Type</option>
                {% for schooltype in schooltypes %}
                <option value="{{ schooltype.id }}">{{ schooltype.name }}</option>
                {% endfor %}
            </select><br>

            <label for="subject_id">Subject:</label>
            <select id="subject_id" name="subject_id" required onchange="updateTutors()">
                <option value="">Select a Subject</option>
                <!-- Subjects will be populated based on school type selection -->
            </select><br>

            <label for="tutor_id">Tutor:</label>
            <select id="tutor_id" name="tutor_id" required>
                <option value="">Select a Tutor</option>
                <!-- Tutors will be populated based on subject selection -->
            </select><br>

            <!-- Your other fields for date, start time, end time, etc. -->

            <input type="submit" value="Add Lesson" class="btn btn-primary">
        </form>
    </div>

    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>
    <script>
        function updateSubjects() {
            var schooltypeId = document.getElementById('schooltype_id').value;
            // Clear current options
            document.getElementById('subject_id').innerHTML = '<option value="">Select a Subject</option>';
            document.getElementById('tutor_id').innerHTML = '<option value="">Select a Tutor</option>';
            if (schooltypeId) {
                fetch('/get_subjects/' + schooltypeId).then(function(response) {
                    return response.json();
                }).then(function(subjects) {
                    var subjectSelect = document.getElementById('subject_id');
                    subjects.forEach(function(subject) {
                        subjectSelect.options[subjectSelect.options.length] = new Option(subject.name, subject.id);
                    });
                });
            }
        }

        function updateTutors() {
            var subjectId = document.getElementById('subject_id').value;
            document.getElementById('tutor_id').innerHTML = '<option value="">Select a Tutor</option>';
            if (subjectId) {
                fetch('/get_tutors/' + subjectId).then(function(response) {
                    return response.json();
                }).then(function(tutors) {
                    var tutorSelect = document.getElementById('tutor_id');
                    tutors.forEach(function(tutor) {
                        tutorSelect.options[tutorSelect.options.length] = new Option(tutor.name, tutor.id);
                    });
                });
            }
        }
    </script>
</body>
</html>
